<app-header></app-header>

<!-- Hasta SeÃ§imi -->
<div class="form-group">
  <label>Hasta SeÃ§in:</label>
  <select [(ngModel)]="selectedPatientId" (change)="onPatientChange()">
    <option value="">-- Hasta SeÃ§in --</option>
    <option *ngFor="let patient of patients" [value]="patient.id">
      {{ patient.name }} {{ patient.surname }}
    </option>
  </select>
</div>

<!-- ğŸ”¥ Hasta seÃ§ilince yÃ¶nlendirme butonlarÄ± -->
<div *ngIf="selectedPatientId && activeTab === ''" class="form-group">
  <button (click)="activeTab = 'add'">Test Sonucu Ekle</button>
  <button (click)="activeTab = 'list'">Test SonuÃ§larÄ±nÄ± GÃ¶r</button>
</div>

<!-- ğŸ”¥ Test Sonucu Ekleme AlanÄ± -->
<div *ngIf="selectedPatientId && activeTab === 'add'">
    <button (click)="activeTab = ''">â† Geri</button>

  
  <!-- Test TÃ¼rÃ¼ SeÃ§imi -->
  <div class="form-group">
    <label>Test TÃ¼rÃ¼:</label>
    <select [(ngModel)]="testType" (change)="onTestTypeChange()">
      <option [value]="'DIGER'">DiÄŸer</option>
      <option value="KAN_TAHLILI">Kan Tahlili</option>
      <option value="IDRAR_TAHLILI">Ä°drar Tahlili</option>
      <option value="MRI">MRI</option>
      <option value="TOMOGRAFI">Tomografi</option>
    </select>
  </div>

  <!-- Test Parametreleri -->
  <div *ngIf="testParameters.length > 0">
    <div class="form-group" *ngFor="let param of testParameters">
      <label>{{ param.name }}</label>
      <input type="text" [(ngModel)]="param.value" placeholder="DeÄŸer girin (Opsiyonel)" />
    </div>
  </div>

  <!-- Doktor Yorumu -->
  <div class="form-group">
    <label>Doktor Yorumu (Opsiyonel):</label>
    <textarea [(ngModel)]="doctorComment" placeholder="Varsa yorum yazÄ±n"></textarea>
  </div>

  <!-- Test Tarihi -->
  <div class="form-group">
    <label>Test Tarihi:</label>
    <input type="date" [(ngModel)]="testDate" />
  </div>

  <!-- Kaydet Butonu -->
  <button (click)="createTestResult()">Test Sonucu Kaydet</button>

</div>

<!-- ğŸ”¥ Test SonuÃ§larÄ±nÄ± GÃ¶rme AlanÄ± -->
<div *ngIf="selectedPatientId && activeTab === 'list'" class="tab-content">
    <button (click)="activeTab = ''">â† Geri</button>

  <h2>Test SonuÃ§larÄ±</h2>

  <div *ngIf="testResults.length === 0">
    <p>SeÃ§ilen hastaya ait test sonucu bulunamadÄ±.</p>
  </div>

  <div *ngFor="let test of testResults" class="test-result-card">
    <p><strong>Test AdÄ±:</strong> {{ test.testName }}</p>
    <p><strong>SonuÃ§ DetayÄ±:</strong><br /> {{ test.result }}</p>
    <p><strong>Doktor Yorumu:</strong> {{ test.doctorComment || '-' }}</p>
    <p><strong>Tarih:</strong> {{ test.testDate }}</p>
     <!-- ğŸ”¥ Sil Butonu -->
  <button (click)="deleteTestResult(test.id)">ğŸ—‘ï¸ Sil</button>
  <button (click)="editTestResult(test)">âœï¸ DÃ¼zenle</button>
  </div>
</div>
