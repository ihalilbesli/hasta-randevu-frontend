<app-header></app-header>
<app-ai-chat></app-ai-chat>

<div class="complaint-form">
  <h2>ğŸ˜  Åikayet OluÅŸtur</h2>

  <form (ngSubmit)="onSubmit()" #complaintForm="ngForm">
    <!-- Konu seÃ§imi -->
    <div class="form-group">
      <label for="subject">Konu</label>
      <select [(ngModel)]="subject" name="subject" id="subject" required>
        <option [ngValue]="''" disabled>-- Konu SeÃ§iniz --</option>
        <option *ngFor="let konu of konuListesi" [value]="konu">{{ konu }}</option>
      </select>
    </div>

    <!-- Klinik seÃ§imi sadece belirli konularda -->
    <div class="form-group" *ngIf="showClinicSelect">
      <label for="clinic">Klinik</label>
      <select [(ngModel)]="selectedClinicId" name="clinic" id="clinic">
        <option [ngValue]="null">-- Klinik seÃ§iniz --</option>
        <option *ngFor="let c of clinics" [ngValue]="c.id">{{ c.name }}</option>
      </select>
    </div>

    <!-- Åikayet iÃ§eriÄŸi -->
    <div class="form-group">
      <label for="content">Åikayetiniz</label>
      <textarea
        id="content"
        name="content"
        [(ngModel)]="content"
        required
        rows="4"
        [placeholder]="placeholderText"
      ></textarea>
    </div>

    <button type="submit" [disabled]="!complaintForm.form.valid">GÃ¶nder</button>
  </form>

  <h3 class="mt-4">ğŸ“œ Ã–nceki Åikayetlerim</h3>
  <label>
    Zaman filtresi:
    <select [(ngModel)]="selectedPeriod" (change)="loadComplaints()">
      <option value="all">TÃ¼mÃ¼</option>
      <option value="week">Son 1 Hafta</option>
      <option value="month">Son 1 Ay</option>
      <option value="year">Son 1 YÄ±l</option>
    </select>
  </label>

  <table *ngIf="complaints.length > 0">
    <thead>
      <tr>
        <th>Konu</th>
        <th>Ä°Ã§erik</th>
        <th>Tarih</th>
        <th>Durum</th>
        <th>AÃ§Ä±klama</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of complaints">
        <td>{{ c.subject }}</td>
        <td>{{ c.content }}</td>
        <td>{{ c.createdAt }}</td>
        <td>{{ c.status }}</td>
        <td>{{ c.adminNote || 'âœ‰ï¸ HenÃ¼z yanÄ±tlanmadÄ±' }}</td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="complaints.length === 0">Åikayet bulunamadÄ±.</p>
</div>
